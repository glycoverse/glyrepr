<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Power User Guide: Efficient Glycan Manipulation ‚Ä¢ glyrepr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power User Guide: Efficient Glycan Manipulation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyrepr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/glyrepr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/glycan-graph.html">Glycan Graphs: The Network Behind Your Sugar Structures üï∏Ô∏è</a></li>
    <li><a class="dropdown-item" href="../articles/iupac.html">Decoding Glycans: Your Guide to IUPAC-Condensed Format</a></li>
    <li><a class="dropdown-item" href="../articles/smap.html">Power User Guide: Efficient Glycan Manipulation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Power User Guide: Efficient Glycan Manipulation</h1>
            
      

      <div class="d-none name"><code>smap.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="welcome-to-the-advanced-zone">Welcome to the Advanced Zone! üöÄ<a class="anchor" aria-label="anchor" href="#welcome-to-the-advanced-zone"></a>
</h2>
<p>Ready to unlock the <strong>full potential</strong> of
<code>glyrepr</code>? This vignette is for those who want to peek under
the hood and master the art of efficient glycan computation. If you‚Äôre
writing custom functions for glycan analysis or building the next great
glycomics tool, you‚Äôre in the right place!</p>
<p><strong>Fair warning</strong>: This guide assumes you‚Äôre comfortable
with R programming and graph theory concepts. If you‚Äôre just getting
started, check out our ‚ÄúGetting Started with glyrepr‚Äù vignette
first.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyrepr/">glyrepr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-secret-superpower-unique-structure-optimization">The Secret Superpower: Unique Structure Optimization<a class="anchor" aria-label="anchor" href="#the-secret-superpower-unique-structure-optimization"></a>
</h2>
<p>Before we dive into the <code>smap</code> functions, let‚Äôs understand
why they exist and why they‚Äôre <strong>game-changing</strong> for glycan
analysis.</p>
<div class="section level3">
<h3 id="the-problem-glycan-computation-is-expensive">The Problem: Glycan Computation is Expensive üí∏<a class="anchor" aria-label="anchor" href="#the-problem-glycan-computation-is-expensive"></a>
</h3>
<p>Working with glycan structures means working with graphs, and graph
operations are computationally expensive. When you‚Äôre analyzing
thousands of glycans from a large-scale study, this becomes a real
bottleneck.</p>
</div>
<div class="section level3">
<h3 id="the-solution-work-smart-not-hard">The Solution: Work Smart, Not Hard üß†<a class="anchor" aria-label="anchor" href="#the-solution-work-smart-not-hard"></a>
</h3>
<p><code>glyrepr</code> implements a clever optimization called
<strong>unique structure storage</strong>. Instead of storing thousands
of identical graphs, it stores only the unique ones and keeps track of
which original positions they belong to.</p>
<p>Let‚Äôs see this in action:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Our test data: some common glycan structures</span></span>
<span><span class="va">iupacs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc(b1-"</span>,  <span class="co"># N-glycan core</span></span>
<span>  <span class="st">"Gal(b1-3)GalNAc(a1-"</span>,                                    <span class="co"># O-glycan core 1</span></span>
<span>  <span class="st">"Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-"</span>,                     <span class="co"># O-glycan core 2</span></span>
<span>  <span class="st">"Man(a1-3)[Man(a1-6)]Man(a1-3)[Man(a1-6)]Man(a1-"</span>,          <span class="co"># Branched mannose</span></span>
<span>  <span class="st">"GlcNAc6Ac(b1-4)Glc3Me(a1-"</span>                              <span class="co"># With decorations</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">struc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_glycan_structure.html">as_glycan_structure</a></span><span class="op">(</span><span class="va">iupacs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now let's create a realistic dataset with lots of repetition</span></span>
<span><span class="va">large_struc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">struc</span>, <span class="fl">1000</span><span class="op">)</span>  <span class="co"># 5,000 total structures</span></span>
<span><span class="va">large_struc</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[5000]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [2] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [3] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)[<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)]<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [4] <span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [5] GlcNAc6Ac(<span style="color: #B2B2B2;">b1-4</span>)Glc3Me(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [6] <span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [7] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [8] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)[<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)]<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [9] <span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [10] GlcNAc6Ac(<span style="color: #B2B2B2;">b1-4</span>)Glc3Me(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; ... (4990 more not shown)</span></span>
<span><span class="co">#&gt; # Unique structures: 5</span></span></code></pre></div>
<p>Notice that magical ‚Äú# Unique structures: 5‚Äù? That‚Äôs your performance
booster right there!</p>
<p>Let‚Äôs verify this optimization is real:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only 5 unique graphs are stored internally</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="st">"structures"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span></span>
<span><span class="co"># But we have 5,000 total elements</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">large_struc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-memory-savings-are-real">The Memory Savings Are Real<a class="anchor" aria-label="anchor" href="#the-memory-savings-are-real"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lobstr.r-lib.org/" class="external-link">lobstr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lobstr.r-lib.org/reference/obj_size.html" class="external-link">obj_sizes</a></span><span class="op">(</span><span class="va">struc</span>, <span class="va">large_struc</span><span class="op">)</span></span>
<span><span class="co">#&gt; * 14.33 kB</span></span>
<span><span class="co">#&gt; * 80.72 kB</span></span></code></pre></div>
<p><strong>80 kB vs 15 MB?</strong> That‚Äôs a 200x memory efficiency! But
the real magic happens with computation speed‚Ä¶</p>
</div>
</div>
<div class="section level2">
<h2 id="enter-the-smap-universe">Enter the <code>smap</code> Universe üåå<a class="anchor" aria-label="anchor" href="#enter-the-smap-universe"></a>
</h2>
<p>Now here‚Äôs the problem: if you try to use regular
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code> functions on glycan
structures, you‚Äôll hit a wall:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This won't work and will throw an error</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"üí• Error:"</span>, <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/cnd_message.html" class="external-link">cnd_message</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; üí• Error: <span style="color: #00BBBB;">‚Ñπ</span> In index: 1.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in `ensure_igraph()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Must provide a graph object (provided wrong object type).</span></span></code></pre></div>
<p><strong>Why does this fail?</strong> Because <code>purrr</code>
functions don‚Äôt understand the internal structure optimization of
<code>glycan_structure</code> objects.</p>
<div class="section level3">
<h3 id="the-smap-family-to-the-rescue">The <code>smap</code> Family to the Rescue!<a class="anchor" aria-label="anchor" href="#the-smap-family-to-the-rescue"></a>
</h3>
<p>The <code>smap</code> functions (think ‚Äú<strong>s</strong>tructure
map‚Äù) are drop-in replacements for <code>purrr</code> functions that are
<strong>glycan-aware</strong>. They understand the unique structure
optimization and work directly with the underlying graph objects.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This works beautifully!</span></span>
<span><span class="va">vertex_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_int</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vertex_counts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 5 2 3 5 2 5 2 3 5 2</span></span></code></pre></div>
<p><strong>The ‚Äús‚Äù stands for ‚Äústructure‚Äù</strong> ‚Äî these functions
operate on the underlying <code>igraph</code> objects that represent
your glycan structures.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-complete-smap-toolkit">The Complete <code>smap</code> Toolkit üõ†Ô∏è<a class="anchor" aria-label="anchor" href="#the-complete-smap-toolkit"></a>
</h2>
<p>The <code>smap</code> family provides glycan-aware equivalents for
virtually all <code>purrr</code> functions:</p>
<table class="table">
<thead><tr class="header">
<th>purrr</th>
<th>smap</th>
<th>purrr</th>
<th>smap</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code></td>
<td><code><a href="../reference/smap.html">smap()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2()</a></code></td>
<td><code><a href="../reference/smap2.html">smap2()</a></code></td>
</tr>
<tr class="even">
<td><code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl()</a></code></td>
<td><code><a href="../reference/smap.html">smap_lgl()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_lgl()</a></code></td>
<td><code><a href="../reference/smap2.html">smap2_lgl()</a></code></td>
</tr>
<tr class="odd">
<td><code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int()</a></code></td>
<td><code><a href="../reference/smap.html">smap_int()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_int()</a></code></td>
<td><code><a href="../reference/smap2.html">smap2_int()</a></code></td>
</tr>
<tr class="even">
<td><code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl()</a></code></td>
<td><code><a href="../reference/smap.html">smap_dbl()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_dbl()</a></code></td>
<td><code><a href="../reference/smap2.html">smap2_dbl()</a></code></td>
</tr>
<tr class="odd">
<td><code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr()</a></code></td>
<td><code><a href="../reference/smap.html">smap_chr()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_chr()</a></code></td>
<td><code><a href="../reference/smap2.html">smap2_chr()</a></code></td>
</tr>
<tr class="even">
<td><code><a href="https://purrr.tidyverse.org/reference/every.html" class="external-link">some()</a></code></td>
<td><code><a href="../reference/smap_predicates.html">ssome()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap()</a></code></td>
<td><code><a href="../reference/spmap.html">spmap()</a></code></td>
</tr>
<tr class="odd">
<td><code><a href="https://purrr.tidyverse.org/reference/every.html" class="external-link">every()</a></code></td>
<td><code><a href="../reference/smap_predicates.html">severy()</a></code></td>
<td><code>pmap_*()</code></td>
<td><code>spmap_*()</code></td>
</tr>
<tr class="even">
<td><code><a href="https://purrr.tidyverse.org/reference/every.html" class="external-link">none()</a></code></td>
<td><code><a href="../reference/smap_predicates.html">snone()</a></code></td>
<td><code><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap()</a></code></td>
<td><code><a href="../reference/simap.html">simap()</a></code></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><code>imap_*()</code></td>
<td><code>simap_*()</code></td>
</tr>
</tbody>
</table>
<p><strong>Simple rule</strong>: Replace <code>map</code> with
<code>smap</code>, <code>pmap</code> with <code>spmap</code>, and
<code>imap</code> with <code>simap</code>. Everything else works exactly
like <code>purrr</code>!</p>
<div class="section level3">
<h3 id="lets-put-them-to-work">Let‚Äôs Put Them to Work!<a class="anchor" aria-label="anchor" href="#lets-put-them-to-work"></a>
</h3>
<p><strong>Count vertices in each structure:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertex_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_int</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">vertex_counts</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     2.0     2.0     3.0     3.4     5.0     5.0</span></span></code></pre></div>
<p><strong>Find structures with more than 4 vertices:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">has_many_vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_lgl</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">has_many_vertices</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000</span></span></code></pre></div>
<p><strong>Get the degree sequence of each structure:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">degree_sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">degree_sequences</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>  <span class="co"># Show first 3</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; 1 2 3 4 5 </span></span>
<span><span class="co">#&gt; 1 2 3 1 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; 1 2 </span></span>
<span><span class="co">#&gt; 1 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; 1 2 3 </span></span>
<span><span class="co">#&gt; 2 1 1</span></span></code></pre></div>
<p><strong>Check if any structure has isolated vertices:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/smap_predicates.html">ssome</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p><strong>Verify all structures are connected:</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/smap_predicates.html">severy</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/components.html" class="external-link">is_connected</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="beyond-basic-smap">Beyond Basic <code>smap()</code><a class="anchor" aria-label="anchor" href="#beyond-basic-smap"></a>
</h3>
<p>Quick examples of the extended family:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># smap2: Apply function with additional parameters</span></span>
<span><span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">large_enough</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap2.html">smap2_lgl</a></span><span class="op">(</span><span class="va">struc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">thresholds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">g</span>, <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">threshold</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">large_enough</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simap: Include position information</span></span>
<span><span class="va">indexed_report</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simap.html">simap_chr</a></span><span class="op">(</span><span class="va">large_struc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">g</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"#"</span>, <span class="va">i</span>, <span class="st">": "</span>, <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, <span class="st">" vertices"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">indexed_report</span></span>
<span><span class="co">#&gt; [1] "#1: 5 vertices" "#2: 2 vertices" "#3: 3 vertices"</span></span></code></pre></div>
<p>‚ö†Ô∏è <strong>Performance Warning</strong>: <code>simap</code> functions
don‚Äôt benefit from the unique structure optimization! Since each element
has a different index, the combination of
<code>(structure, index)</code> is always unique, breaking the
deduplication that makes other <code>smap</code> functions fast. Use
<code>simap</code> only when you truly need position information.</p>
</div>
</div>
<div class="section level2">
<h2 id="performance-the-magic-of-deduplication">Performance: The Magic of Deduplication ‚ö°<a class="anchor" aria-label="anchor" href="#performance-the-magic-of-deduplication"></a>
</h2>
<p>The beauty of <code>smap</code> functions lies in automatic
deduplication:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a large dataset with high redundancy</span></span>
<span><span class="va">huge_struc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">struc</span>, <span class="fl">5000</span><span class="op">)</span>  <span class="co"># 25,000 structures, only 5 unique</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dataset size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">huge_struc</span><span class="op">)</span>, <span class="st">"structures\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dataset size: 25000 structures</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unique structures:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">huge_struc</span>, <span class="st">"structures"</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unique structures: 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Redundancy factor:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">huge_struc</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">huge_struc</span>, <span class="st">"structures"</span><span class="op">)</span><span class="op">)</span>, <span class="st">"x\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Redundancy factor: 5000 x</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jabiru/tictoc" class="external-link">tictoc</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optimized approach: smap only processes 5 unique structures</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="st">"smap_int (optimized)"</span><span class="op">)</span></span>
<span><span class="va">vertex_counts_optimized</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_int</a></span><span class="op">(</span><span class="va">huge_struc</span>, <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; smap_int (optimized): 0.002 sec elapsed</span></span>
<span></span>
<span><span class="co"># Naive approach: extract all graphs and process each one</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="st">"Naive approach (all graphs)"</span><span class="op">)</span></span>
<span><span class="va">all_graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_structure_graphs.html">get_structure_graphs</a></span><span class="op">(</span><span class="va">huge_struc</span><span class="op">)</span>  <span class="co"># Extracts all 25,000 graphs</span></span>
<span><span class="va">vertex_counts_naive</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">all_graphs</span>, <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Naive approach (all graphs): 0.258 sec elapsed</span></span>
<span></span>
<span><span class="co"># Verify results are equivalent (though data types may differ)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">vertex_counts_optimized</span>, <span class="va">vertex_counts_naive</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><strong>The higher the redundancy, the bigger the performance
gain!</strong> In real glycoproteomics datasets with repeated
structures, this optimization can provide about 10x speedups.</p>
</div>
<div class="section level2">
<h2 id="advanced-patterns-and-tips">Advanced Patterns and Tips üí°<a class="anchor" aria-label="anchor" href="#advanced-patterns-and-tips"></a>
</h2>
<div class="section level3">
<h3 id="working-with-complex-functions">Working with Complex Functions<a class="anchor" aria-label="anchor" href="#working-with-complex-functions"></a>
</h3>
<p>The function you pass to <code>smap</code> must accept an
<code>igraph</code> object as its first argument. You can use
purrr-style lambda notation:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate clustering coefficient for each structure</span></span>
<span><span class="va">clustering_coeffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_dbl</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/transitivity.html" class="external-link">transitivity</a></span><span class="op">(</span><span class="va">.x</span>, type <span class="op">=</span> <span class="st">"global"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">clustering_coeffs</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt;       0       0       0       0       0       0    2000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="combining-multiple-metrics">Combining Multiple Metrics<a class="anchor" aria-label="anchor" href="#combining-multiple-metrics"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a comprehensive analysis</span></span>
<span><span class="va">structure_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="kw">function</span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    vertices <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>,</span>
<span>    edges <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gsize.html" class="external-link">ecount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>,</span>
<span>    diameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/components.html" class="external-link">is_connected</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/diameter.html" class="external-link">diameter</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    clustering <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/transitivity.html" class="external-link">transitivity</a></span><span class="op">(</span><span class="va">g</span>, type <span class="op">=</span> <span class="st">"global"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to a more usable format</span></span>
<span><span class="va">analysis_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">structure_analysis</span>, <span class="va">data.frame</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">analysis_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   vertices edges diameter clustering</span></span>
<span><span class="co">#&gt; 1        5     4        3          0</span></span>
<span><span class="co">#&gt; 2        2     1        1        NaN</span></span>
<span><span class="co">#&gt; 3        3     2        1          0</span></span>
<span><span class="co">#&gt; 4        5     4        2          0</span></span>
<span><span class="co">#&gt; 5        2     1        1        NaN</span></span>
<span><span class="co">#&gt; 6        5     4        3          0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="memory-efficient-filtering">Memory-Efficient Filtering<a class="anchor" aria-label="anchor" href="#memory-efficient-filtering"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find only structures with exactly 5 vertices</span></span>
<span><span class="va">has_five_vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_lgl</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="op">~</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">five_vertex_structures</span> <span class="op">&lt;-</span> <span class="va">large_struc</span><span class="op">[</span><span class="va">has_five_vertices</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Found"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">has_five_vertices</span><span class="op">)</span>, <span class="st">"structures with exactly 5 vertices\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Found 2000 structures with exactly 5 vertices</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="when-to-use-smap-functions">When to Use <code>smap</code> Functions<a class="anchor" aria-label="anchor" href="#when-to-use-smap-functions"></a>
</h2>
<p><strong>Use <code>smap</code> functions when:</strong></p>
<ul>
<li>‚úÖ You need to apply <code>igraph</code>-based functions to glycan
structures</li>
<li>‚úÖ You want maximum performance with datasets containing repeated
structures</li>
<li>‚úÖ You‚Äôre building custom glycan analysis pipelines</li>
</ul>
<p><strong>Stick with regular R functions when:</strong></p>
<ul>
<li>‚ùå Working with compositions</li>
<li>‚ùå Operating on string representations</li>
</ul>
<p>‚ö†Ô∏è <strong>Special note on <code>simap</code></strong>:</p>
<p>While <code>simap</code> functions are convenient for position-aware
operations, they <strong>don‚Äôt provide performance benefits</strong>
over regular <code>imap</code> functions. The inclusion of index
information breaks the unique structure optimization, making each
<code>(structure, index)</code> pair unique even when structures are
identical.</p>
</div>
<div class="section level2">
<h2 id="real-world-example-custom-motif-detection">Real-World Example: Custom Motif Detection<a class="anchor" aria-label="anchor" href="#real-world-example-custom-motif-detection"></a>
</h2>
<p>Here‚Äôs how you might build a custom glycan analysis pipeline using
<code>smap</code> functions:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Custom motif detector</span></span>
<span><span class="va">detect_branching</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">degrees</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">degrees</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to large dataset - blazingly fast due to unique structure optimization</span></span>
<span><span class="va">has_branching</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap.html">smap_lgl</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="va">detect_branching</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Structures with branching:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">has_branching</span><span class="op">)</span>, <span class="st">"out of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">large_struc</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Structures with branching: 2000 out of 5000</span></span>
<span></span>
<span><span class="co"># Use smap2 to check structures against complexity thresholds</span></span>
<span><span class="va">complexity_thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">1000</span><span class="op">)</span>  <span class="co"># Thresholds for each structure</span></span>
<span><span class="va">meets_threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smap2.html">smap2_lgl</a></span><span class="op">(</span><span class="va">large_struc</span>, <span class="va">complexity_thresholds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">g</span>, <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/gorder.html" class="external-link">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">threshold</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Structures meeting complexity threshold:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">meets_threshold</span><span class="op">)</span>, <span class="st">"out of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">large_struc</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Structures meeting complexity threshold: 2000 out of 5000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="final-thoughts-youre-now-a-power-user">Final Thoughts: You‚Äôre Now a Power User! üéâ<a class="anchor" aria-label="anchor" href="#final-thoughts-youre-now-a-power-user"></a>
</h2>
<p>Congratulations! You now understand the core optimization that makes
<code>glyrepr</code> blazingly fast and how to leverage it with the
<code>smap</code> family of functions.</p>
<p><strong>Key takeaways:</strong> - üß† <strong>Unique structure
optimization</strong> is the secret sauce behind <code>glyrepr</code>‚Äôs
performance - üöÄ <strong><code>smap</code> functions</strong> are
drop-in replacements for <code>purrr</code> that understand glycan
structures - ‚ö° <strong>Performance gains</strong> are dramatic with
large datasets containing repeated structures - üõ†Ô∏è <strong>Use
<code>smap</code> for structures</strong>, regular R functions for
everything else</p>
<p>You‚Äôre now equipped to build the next generation of glycomics
analysis tools. Go forth and analyze! üåü</p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] tictoc_1.2.1  lobstr_1.1.2  glyrepr_0.5.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] jsonlite_2.0.0    dplyr_1.1.4       compiler_4.5.1    tidyselect_1.2.1 </span></span>
<span><span class="co">#&gt;  [5] stringr_1.5.1     jquerylib_0.1.4   systemfonts_1.2.3 textshaping_1.0.1</span></span>
<span><span class="co">#&gt;  [9] yaml_2.3.10       fastmap_1.2.0     R6_2.6.1          generics_0.1.4   </span></span>
<span><span class="co">#&gt; [13] igraph_2.1.4      knitr_1.50        backports_1.5.0   checkmate_2.3.2  </span></span>
<span><span class="co">#&gt; [17] tibble_3.3.0      rstackdeque_1.1.1 desc_1.4.3        bslib_0.9.0      </span></span>
<span><span class="co">#&gt; [21] pillar_1.11.0     rlang_1.1.6       cachem_1.1.0      stringi_1.8.7    </span></span>
<span><span class="co">#&gt; [25] xfun_0.52         fs_1.6.6          sass_0.4.10       cli_3.6.5        </span></span>
<span><span class="co">#&gt; [29] pkgdown_2.1.3     magrittr_2.0.3    digest_0.6.37     lifecycle_1.0.4  </span></span>
<span><span class="co">#&gt; [33] prettyunits_1.2.0 vctrs_0.6.5       evaluate_1.0.4    glue_1.8.0       </span></span>
<span><span class="co">#&gt; [37] ragg_1.4.0        rmarkdown_2.29    purrr_1.1.0       tools_4.5.1      </span></span>
<span><span class="co">#&gt; [41] pkgconfig_2.0.3   htmltools_0.5.8.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
