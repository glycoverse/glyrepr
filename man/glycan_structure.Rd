% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/structure.R
\name{glycan_structure}
\alias{glycan_structure}
\alias{is_glycan_structure}
\title{Create a Glycan Structure Vector}
\usage{
glycan_structure(...)

is_glycan_structure(x)
}
\arguments{
\item{...}{igraph graph objects to be converted to glycan structures, or existing glycan structure vectors.}

\item{x}{An object to check or convert.}
}
\value{
A glycan structure vector object.
}
\description{
A vector of glycan structures with efficient storage using hash-based deduplication.
}
\details{
The underlying implementation uses hash values of IUPAC codes of the glycan structures.
This prevents redundant storage and computation, which is very useful for glycan structures.

Each glycan structure is a directed graph modeling of a glycan structure,
where nodes are monosaccharides and edges are linkages.
}
\section{S3 Classes}{
A glycan structure vector is a vctrs record with additional S3 class \code{glyrepr_structure}.
Therefore, \code{sloop::s3_class()} of a glycan structure vector is
\code{c("glyrepr_structure", "vctrs_rcrd")}.

Constraints for individual structures:
\itemize{
\item The graph must be directed and an outward tree (reducing end as root).
\item The graph must have a graph attribute \code{anomer}, in the form of "a1".
\item The graph must have a vertex attribute \code{mono} for monosaccharide names.
\item The graph must have a vertex attribute \code{sub} for substituents.
\item The graph must have an edge attribute \code{linkage} for linkages.
\item Monosaccharide name must be known, either generic (Hex, HexNAc, etc.)
or concrete (Glc, Gal, etc.), but not a mixture of both.
NA is not allowed.
\item Substituent must be valid. For single substituents, use the form "xY",
where x is position and Y is substituent name, e.g. "2Ac", "3S", etc.
For multiple substituents, separate them with commas and order by position,
e.g. "3Me,4Ac", "2S,6P", etc. Empty string "" means no substituents.
\item Linkages must be valid, in the form of "a/bX-Y", where X and Y are integers,
e.g. "b1-4", "a2-3", etc.
NA is not allowed.
}
}

\examples{
library(igraph)

# A simple glycan structure: GlcNAc(b1-4)GlcNAc
graph <- make_graph(~ 1-+2)  # 1 and 2 are monosaccharides
V(graph)$mono <- c("GlcNAc", "GlcNAc")
V(graph)$sub <- ""
E(graph)$linkage <- "b1-4"
graph$anomer <- "a1"

# Create glycan structure vector
glycan_structure(graph)

# Create vector with multiple structures
glycan_structure(graph, o_glycan_core_1())

}
