% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/structure.R
\name{as_glycan_structure}
\alias{as_glycan_structure}
\alias{is_glycan_structure}
\title{Convert igraph Graph to Glycan Structure}
\usage{
as_glycan_structure(graph)

is_glycan_structure(x)
}
\arguments{
\item{graph}{An igraph graph object.}

\item{x}{An object to check.}
}
\value{
A glycan structure object.
}
\description{
A glycan structure is a subclass of igraph graph with additional constraints.
This function checks these constraints and append the S3 class \code{glycan_structure}
to the graph object.

Generally, \strong{it is not recommended} to create a glycan structure using this
function manually.
Use the \href{https://github.com/glycoverse/glyparse}{glyparse} package
to generate a glycan structure from a structure string.

A glycan structure is a directed modeling of a glycan structure,
where nodes are monosaccharides and edges are linkages.
}
\section{S3 Classes}{
A glycan structure is merely an igraph graph with an additional S3 class \code{glycan_structure}.
Therefore, \code{sloop::s3_class()} of a glycan structure is
\code{c("glycan_structure", "igraph")}.

Constraints:
\itemize{
\item The graph must be directed and an outward tree (reducing end as root).
\item The graph must have a graph attribute \code{anomer}, in the form of "a1".
\item The graph must have a graph attribute \code{alditol}, a logical value.
\item The graph must have a vertex attribute \code{mono} for monosaccharide names.
\item The graph must have a vertex attribute \code{sub} for substituents.
\item The graph must have an edge attribute \code{linkage} for linkages.
\item Monosaccharide name must be known, either generic (Hex, HexNAc, etc.)
or concrete (Glc, Gal, etc.), but not a mixture of both.
NA is not allowed.
\item Substituent must be valid, in the form of "xY", where x is position
and Y is substituent name, e.g. "2Ac", "3S", etc.
\item Linkages must be valid, in the form of "a/bX-Y", where X and Y are integers,
e.g. "b1-4", "a2-3", etc.
NA is not allowed.
}
}

\examples{
library(igraph)

# A simple glycan structure: GlcNAc(b1-4)GlcNAc
graph <- make_graph(~ 1-+2)  # 1 and 2 are monosaccharides
V(graph)$mono <- c("GlcNAc", "GlcNAc")
V(graph)$sub <- ""
E(graph)$linkage <- "b1-4"
graph$anomer <- "a1"
graph$alditol <- FALSE
as_glycan_structure(graph)

}
